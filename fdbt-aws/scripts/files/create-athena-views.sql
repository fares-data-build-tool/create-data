CREATE OR REPLACE VIEW business_intelligence.total_daily_tickets AS SELECT nocCode, COUNT(*) AS dailyTotal FROM business_intelligence.matching_data CROSS JOIN UNNEST(products) AS t(i) WHERE i.productduration = '1 day' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_weekly_tickets AS SELECT nocCode, COUNT(*) AS weeklyTotal FROM business_intelligence.matching_data CROSS JOIN UNNEST(products) AS t(i) WHERE i.productduration = '1 week' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_monthly_tickets AS SELECT nocCode, COUNT(*) AS monthlyTotal FROM business_intelligence.matching_data CROSS JOIN UNNEST(products) AS t(i) WHERE i.productduration = '1 month' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_annual_tickets AS SELECT nocCode, COUNT(*) AS annualTotal FROM business_intelligence.matching_data CROSS JOIN UNNEST(products) AS t(i) WHERE i.productduration = '1 year' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_group_period_tickets AS SELECT nocCode, COUNT(*) AS groupTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'group' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_adult_period_tickets AS SELECT nocCode, COUNT(*) AS adultTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'adult' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_child_period_tickets AS SELECT nocCode, COUNT(*) AS childTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'child' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_infant_period_tickets AS SELECT nocCode, COUNT(*) AS infantTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'infant' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_senior_period_tickets AS SELECT nocCode, COUNT(*) AS seniorTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'senior' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_student_period_tickets AS SELECT nocCode, COUNT(*) AS studentTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'student' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_young_person_period_tickets AS SELECT nocCode, COUNT(*) AS youngPersonTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'youngPerson' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_anyone_period_tickets AS SELECT nocCode, COUNT(*) AS anyoneTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'anyone' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_school_pupil_period_tickets AS SELECT nocCode, COUNT(*) AS schoolPupilTotal FROM business_intelligence.matching_data WHERE (type = 'period' OR type = 'multiOperator') AND passengertype = 'schoolPupil' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_group_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS groupTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'group' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_adult_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS adultTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'adult' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_child_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS childTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'child' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_infant_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS infantTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'infant' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_senior_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS seniorTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'senior' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_student_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS studentTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'student' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_young_person_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS youngPersonTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'youngPerson' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_anyone_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS anyoneTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'anyone' GROUP BY nocCode;
CREATE OR REPLACE VIEW business_intelligence.total_school_pupil_flat_fare_tickets AS SELECT nocCode, COUNT(*) AS schoolPupilTotal FROM business_intelligence.matching_data WHERE type = 'flatFare' AND passengertype = 'schoolPupil' GROUP BY nocCode;
